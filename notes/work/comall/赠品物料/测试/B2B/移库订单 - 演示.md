# 移库订单 - 演示（UAT）

---

## 一、环境信息

- **环境**：UAT

---

## 二、业务场景

1. 商品 + 标配物料  
   - 1 单 3 件  
   - 包含：1 个一退、1 个二退、1 个销售后三退  

2. 单独物料  
   - 1 单 3 件  

3. 单独赠品  
   - 1 单 3 件  

---

## 三、创单 Mock 信息

### 3.1 Mock 地址

```

[https://fs-uat.chowtaifook.sz/admin_api/dc-b2b-order/swagger-ui.html](https://fs-uat.chowtaifook.sz/admin_api/dc-b2b-order/swagger-ui.html)

```

---

### 3.2 Mock 接口说明

- **接口名称**：B2B订单接口（外部接口）
- **Controller**：B2b Order Controller
- **接口路径**：

```

POST /integration/b2b_orders/test/receiveB2bOrderDetail

````

---

## 四、入参说明（可修改字段）

| 字段名 | 说明 |
|------|------|
| `product_code` | 产品编码 |
| `channel_product_code` | 渠道 SKUID（需在磐石建立映射关系） |
| `out_order_id` | 采购单号（每次创单必须唯一） |
| `quantity` | 数量 |

---

## 五、业务场景示例

---

### 5.1 商品 + 标配物料（1 单 3 件）

```json
{
  "b2b_goods_details": [
    {
      "channel_category": "6195",
      "channel_product_code": "10001012171538",
      "discount": 0.0,
      "price": 1.0,
      "product_code": "10001012171538",
      "product_name": "测试配套物料",
      "quantity": 3
    }
  ],
  "channel_type": "JD",
  "dest_warehouse_id": "118",
  "dest_warehouse_name": "上海常温C中件1号库-CHN",
  "out_order_id": "24689612221222001",
  "purchase_time": "2025-12-22 09:56:22",
  "receiver": "张刘霞",
  "receiver_tel": "4006225686-11020,17335617868",
  "receiving_address": "上海市嘉定区兴邦路1166号（亚一三期）6号月台",
  "required_arrival_time": "2025-12-22 09:56:22",
  "vendor_id": "zdf",
  "vendor_name": "深圳周大福在线传媒有限公司"
}
````

---

### 5.2 单独物料（1 单 3 件）

```json
{
  "b2b_goods_details": [
    {
      "channel_category": "6195",
      "channel_product_code": "100145155391",
      "discount": 0.0,
      "price": 0.0,
      "product_code": "100145155391",
      "product_name": "物料测试-1",
      "quantity": 1
    }
  ],
  "channel_type": "JD",
  "dest_warehouse_id": "118",
  "dest_warehouse_name": "上海常温C中件1号库-CHN",
  "out_order_id": "24689612171531234",
  "purchase_time": "2025-12-12 13:50:22",
  "receiver": "张刘霞",
  "receiver_tel": "4006225686-11020,17335617868",
  "receiving_address": "上海市嘉定区兴邦路1166号（亚一三期）6号月台",
  "required_arrival_time": "2025-12-12 13:50:22",
  "vendor_id": "zdf",
  "vendor_name": "深圳周大福在线传媒有限公司"
}
```

---

### 5.3 单独赠品（1 单 3 件）

```json
{
  "b2b_goods_details": [
    {
      "channel_category": "6195",
      "channel_product_code": "100164537369",
      "discount": 0.0,
      "price": 0.0,
      "product_code": "100164537369",
      "product_name": "赠品测试-1",
      "quantity": 1
    },
    {
      "channel_category": "6195",
      "channel_product_code": "100128630644",
      "discount": 0.0,
      "price": 0.0,
      "product_code": "100128630644",
      "product_name": "赠品测试-2",
      "quantity": 1
    }
  ],
  "channel_type": "JD",
  "dest_warehouse_id": "118",
  "dest_warehouse_name": "上海常温C中件1号库-CHN",
  "out_order_id": "24689612171531151",
  "purchase_time": "2025-12-16 15:36:22",
  "receiver": "张刘霞",
  "receiver_tel": "4006225686-11020,17335617868",
  "receiving_address": "上海市嘉定区兴邦路1166号（亚一三期）6号月台",
  "required_arrival_time": "2025-12-16 15:36:22",
  "vendor_id": "zdf",
  "vendor_name": "深圳周大福在线传媒有限公司"
}
```

---

## 六、订单审核流程

### 审核路径

```
订单中心
→ 移库订单管理
→ 移库订单管理
→ 待审核
→ 审核
→ 通过
```

---

## 七、生成出库单（定时任务）

### 7.1 Swagger 地址

```
https://fs-uat.chowtaifook.sz/admin_api/dc-b2b-order/swagger-ui.html
```

---

### 7.2 接口说明

- **接口名称**：B2B订单接口-定时任务专用
    
- **Controller**：B2b Order Job Controller
    
- **接口 Path**：
    

```
/job/b2b_orders/audit_process
```

- **功能说明**：  
    扫描指定时间范围内，满足 **已审核** 状态的移库订单，生成对应出库单。
    

---

### 7.3 入参示例

```json
{
  "create_time_start": "2025-12-23 00:00:00",
  "create_time_end": "2025-12-23 23:59:59"
}
```

---

## 八、异常说明

- 若未生成出库单：
    
    - 可能存在 **脏数据**
        
    - 需联系相关同事清除后再重新执行定时任务
        

---
