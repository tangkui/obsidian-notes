# 京东三退-演示（UAT）

---

```
环境：UAT
```

---

## 三退 场景

1、商品 + 标配物料

- 销售 1 件
    
- 退货 1 件
    

2、单独物料

- 销售 1 件
    
- 退货 1 件
    

3、单独赠品

- 销售 1 件
    
- 退货 1 件
    

---

## Mock 数据前置说明

在创建京东自营 **3 退单据** 之前，需要先在  
`ctf_jd_transfer_order.dc_mock_jdedi` 表中写入对应的 mock 数据。

---

## 查询参考数据（不可修改）

```sql
select * 
from ctf_jd_transfer_order.dc_mock_jdedi 
where order_code in ('333333','444444');
```

该记录不要修改，按照以下操作新增记录。

以 `order_code = 333333` 和 `444444` 的数据为参考，复制 `response_json` 数据。

以下 **2 个 json 报文**，字段值包含【待修改】的数据，都需要修改。

---

### ⚠️ 重要说明

**牌仔必须是移库正向单对应出库单拣货的牌仔**，  
否则入库单会存在问题，且 QC 环节无法通过。

---

## mock 京东渠道备件库详情数据

### （order_code = 333333）

### ⚠️ 特别注意

- `refundId` 取值范围：`-2147483648 ~ 2147483647`
    
- `refundId` **必须唯一**
    
- 否则无法创单成功
    

---

### 完整 JSON 示例

```json
{
  "success": true,
  "code": null,
  "message": null,
  "traceId": null,
  "recordCount": null,
  "data": [
    {
      "wareId": "待修改-渠道SKUID",
      "wareName": "周大福（CHOW TAI FOOK） 精致典雅蛇肚 足金黄金戒指(工费120) 约3.35g EOF187",
      "partCode": "待修改-渠道备件码示例（100020240829）",
      "channelId": "-10000",
      "channelName": "非渠道化",
      "price": 1996,
      "shipCode": "待修改运单号-JDVC248292",
      "signTime": 1682164300000,
      "remark": "",
      "confirmReceiptPeople": "青龙_linkangjie1",
      "refundId": "待修改渠道退单ID（示例24082920）"
    }
  ]
}
```

---

### 新增 SQL

```sql
INSERT INTO ctf_jd_transfer_order.dc_mock_jdedi 
(response_json, path, order_code) 
VALUES 
('填入json', '/services/sparePartInventory/refundInfoDetail', '填入refundId');
```

---

## mock 京东渠道备件库物流发运详情数据

### （order_code = 444444）

### ⚠️ 字段强约束说明

- `shipCode`  
    必须与 **333333 报文的 shipCode 一致**
    
- `partCode`  
    必须与 **333333 报文的 partCode 一致**
    
- `wareId`  
    必须与 **333333 报文的 wareId 一致**
    

否则无法获取对应牌仔数据。

---

### 完整 JSON 示例

```json
{
  "success": true,
  "code": null,
  "message": null,
  "traceId": null,
  "recordCount": null,
  "data": {
    "shipCode": "修改运单号（示例JDVC248292）",
    "createTime": 1681864974000,
    "receiveAddress": "",
    "receiveName": "深圳周大福在线传媒有限公司",
    "contactName": "",
    "contactTel": "",
    "sumPackagePrice": 40740.8,
    "orgId": 10,
    "orgName": "广州分公司",
    "storeId": 1,
    "storeName": "广州3C逆向库",
    "carriersName": "京东快递",
    "packageStatus": 200,
    "signTime": 1682164300000,
    "confirmReceiptPeople": "青龙_linkangjie1",
    "packageDetailList": [
      {
        "partCode": "修改渠道备件码（示例100020240829）",
        "channelId": "-10000",
        "channelName": "非渠道化",
        "sn": "待修改牌仔（移库正向单的牌仔）",
        "wareId": "待修改渠道SKUID-1000320230501",
        "wareName": "周大福（CHOW TAI FOOK） 精致典雅蛇肚 足金黄金戒指(工费120) 约3.35g EOF187",
        "packagePrice": 7924,
        "transferOutCode": "1189517082",
        "outType": 100,
        "outTypeDesc": "直退",
        "downTime": 1681825239000,
        "returnReason": null
      }
    ]
  }
}
```

---

### 新增 SQL

```sql
INSERT INTO ctf_jd_transfer_order.dc_mock_jdedi 
(response_json, path, order_code) 
VALUES 
('填入json', '/services/sparePartInventory/shipPackageDetail', '填入shipCode');
```

---

## 创单 Mock 地址

```
https://fs-uat.chowtaifook.sz/admin_api/dc-b2b-order/swagger-ui.html
```

---

## 接口说明

**B2B 退货单 - 运维**  
Ops Return Order Controller

```
POST
/ops/return_orders/mock/receive_return_order_detail
```

Mock 生成 2B 移库退货单

---

## 请求参数示例

```json
{
  "channel_code": 1001,
  "channel_warehouse_code": "2426",
  "channel_warehouse_name": "北京市大兴区黄村镇魏永路70号京威股份北400米京东北京亚一园区",
  "purchase_order_code": "20251223000008",
  "refund_type": "SALE_RETURN",
  "return_create_time": "2025-12-15 17:19:27",
  "return_order_code": "1656494747",
  "return_order_goods_detail_list": [
    {
      "actual_quantity": 1,
      "apply_quantity": 1,
      "channel_sku_code": "10001012171538",
      "return_price": 0
    }
  ],
  "shop_code": 60623,
  "shop_name": "周大福京东自营店",
  "type": "SOLD",
  "vendor_id": "zdf"
}
```

---

## 可修改字段说明

- `return_order_code`  
    → 必须对应 **333333 mock 报文中的 refundId**
    
- `purchase_order_code`  
    → 采购单号
    
- `channel_sku_code`  
    → 渠道 SKU ID
    
- `actual_quantity`  
    → 实际数量
    
- `apply_quantity`  
    → 申请数量
    

--- 
